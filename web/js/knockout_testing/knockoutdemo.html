<html>
<head>

<script src="inc/js/jquery.js"></script>
<script src="inc/js/knockout-2.2.0.js"></script>


<style type="text/css">

    body
    {
        background-color: #56789a;
        font-family:tahoma;
        color: #FFFFFF;
    }

	.demo
	{
        width: 65%;
        margin: auto;
        margin-top: 20px;
        margin-bottom: 20px;
		border: 1px solid black;
		background-color: #FFF;
		color: #000;
		padding: 4px;
		-moz-border-radius: 4px;
		-webkit-border-radius: 4px;
		border-radius: 4px;        
        -webkit-box-shadow: 3px 3px 10px #333333;	
        -moz-box-shadow: 3px 3px 10px #333333;
        box-shadow: 3px 3px 10px #333333;		

	}

    .demo h2
    {
    	font-size: 32px;
        color: #CDCDCD;
        text-align: center;
        text-shadow: 2px 2px 4px #666666;
    }	

    .demoSection
    {
    	width:80%;
    	margin: auto;
    	margin-bottom: 10px;
    	border: 1px solid #CCCCCC;
		padding: 4px;
		-moz-border-radius: 4px;
		-webkit-border-radius: 4px;
		border-radius: 4px;            	
    }
    .demoSection h2
    {
    	margin-top: 5px;
    	color: #56789a;
    	font-size: 20px;
    	text-shadow: 2px 2px 4px #FFF;
    }

</style>

<script type="text/javascript">

	$(document).ready(function () {
		demo1Init();
		$("#demo1 #addBtn").click(addArea);
		$("#addNewArea").click(addNewArea);
		fetchData();

	});

	//
	// demo 1
	//

	var testViewModel =  {
	 	name : ko.observable("Mike"),
	 	age : ko.observable(45),

	 	favoriteSkiAreas : ko.observableArray([
	 			{ AreaName: "Stowe" },
	 			{ AreaName: "Mad River Glen"},
	 			{ AreaName: "Sugarbush" }
	 		]),

	 	selectedSkiArea : ko.observable(),
	 	skiAreaToAdd: ko.observable(),

		//
		// demo 2 - data loaded via ajax/json
		//
		music: ko.observable(""),
		activityList : ko.observableArray(),

		//
		// demo 3 - forms
		//
        numberOfClicks : ko.observable(0),
		places : ko.observableArray(['London', 'Paris', 'Tokyo']),

        incrementClickCounter : function() {
            var previousCount = this.numberOfClicks();
            this.numberOfClicks(previousCount + 1);
        },

         // The current item will be passed as the first parameter, 
         // so we know which place to remove
        removePlace : function(place) {
             testViewModel.places.remove(place);
         },

        submitForm: function(formelement){
        	alert("you've submitted the form!");
     	},

     	hasCellphone : ko.observable(false),
        cellphoneNumber: "",

        userName: ko.observable(""),        // Initially blank
        userPassword: ko.observable("abc"), // Prepopulate        
        selectedOS: ko.observable(""),

        wantsSpam : ko.observable(true)


	 };

	 function uncheckSpamOption()
	 {
	 	var valueToSet = testViewModel.wantsSpam()? false : true;
 		testViewModel.wantsSpam(valueToSet);
	 }

	 function addArea()
	 {
	 	testViewModel.favoriteSkiAreas.push({ AreaName: "Sunday River" });
	 }

	 function addNewArea()
	 {
	 	var newArea = testViewModel.skiAreaToAdd() ? testViewModel.skiAreaToAdd() : "";

	 	if (newArea.length > 0)
	 	{
	 		testViewModel.favoriteSkiAreas.push({AreaName : newArea});
	 	}
	 }

	function demo1Init()
	{
		ko.applyBindings(testViewModel);
	}
	
	function fetchData()
	{
		//
		// note: demo doesn't work run locally in chrome due to security restrictions to local files... should load off a server ok
		//
		$.ajax({
		    type : 'GET',
		    dataType : 'json',
		    url: 'data.json',
		    async: false,
		    success : function(data) {
		    	testViewModel.music(data.music);

		        $.each(data.activities, function(index, obj){
		        	testViewModel.activityList.push(obj);
		        });
		    } 
		});		
	}


</script>	


</head>
<body>

<!-- demo 1 -->
<div id="demo1" class="demo">
<h2>Knockout Test 1</h2>

<span>Name:</span> <span data-bind="text: name"></span>
<br />

<span>Age:</span> <span data-bind="text: age"></span>
<br>

<span>Number of areas: </span><span data-bind="text: favoriteSkiAreas() ? favoriteSkiAreas().length : 0 "></span>
<br>

<span>Selected area: </span><span data-bind="text: selectedSkiArea() ? selectedSkiArea().AreaName : 'none' "></span>
<br />

<button id="addBtn">Add Sunday River Ski Area</button>
<br>

<span>Add your own area: </span><input type="text" data-bind="value: skiAreaToAdd, valueUpdate: 'change'"><button id="addNewArea">Add</button>
<br>

<span>Array as select</span>
<br>
<select data-bind="options: favoriteSkiAreas, value: selectedSkiArea, optionsText: 'AreaName', optionsCaption: 'Choose...'"></select>
<br />

<span>Array as list</span>
<ul data-bind="foreach: favoriteSkiAreas">
	<li data-bind="text: AreaName"></li>
</ul>

</div>

<!-- demo 2 -->
<div class="demo">
<h2>Knockout Test 2</h2>
<p>Loading data via ajax/JSON</p>
<br />

<span>Music: </span><span data-bind="text: music"></span>
<br>

<span>Activities:</span>
<br>
<ul data-bind="foreach: activityList">
	<li data-bind="text: name"></li>
</ul>

<br>
</div>


<!-- demo 3 -->
<div class="demo">
<h2>Knockout Test 3</h2>
<p>Bindings that are usefull with Forms</p>
<br />

<div class="demoSection">
	<h2>Click Binding</h2>
    You've clicked <span data-bind="text: numberOfClicks"></span> times
    <button data-bind="click: incrementClickCounter">Click me</button>
    <br />

	<ul data-bind="foreach: places">
	    <li>
	        <span data-bind="text: $data"></span>
	        <button data-bind="click: $root.removePlace">Remove</button>
	    </li>
	</ul>    
</div>

<div class="demoSection">
	<h2>Submit Binding</h2>
	Bind form submission to a javascript function... will work with button click, enter etc
	<form data-bind="submit: submitForm">
		<button>Submit already</button>
	</form>
</div>	

<div class="demoSection">
	<h2>Enable Binding</h2>
	element enabled based on model property 
<p>
    <input type='checkbox' data-bind="checked: hasCellphone" />
    I have a cellphone
</p>
<p>
    Your cellphone number:
    <input type='text' data-bind="value: cellphoneNumber, enable: hasCellphone" />
</p>
</div>	

<div class="demoSection">
	<h2>Value Binding</h2>
For use with input, select &amp; textarea elements	

<p>Login name: <input data-bind="value: userName" /></p>
<p>Password: <input type="password" data-bind="value: userPassword" /></p>
<p>OS: <select data-bind="value: selectedOS"><option>OS X</option><option>Linux</option><option>Windows</option></select></p>
<br>
<span>debug:</span>&nbsp;<span>[login] == </span><span data-bind="text: userName"></span>&nbsp;<span>[pswd] == </span><span data-bind="text: userPassword"></span>
<span>[os] == </span><span data-bind="text: selectedOS"></span>

</div>	

<div class="demoSection">
	<h2>Checked Binding</h2>
For use with check boxes and radio buttons elements	

<p>Send me spam: <input type="checkbox" data-bind="checked: wantsSpam" /></p>
<button data-bind="click: uncheckSpamOption">Change Mind</button>
</div>	

<br>
</div>


<!-- demo debug -->
<div class="demo">
<h2>ViewModel Data Debug</h2>

<hr noshade />

<pre data-bind="text: ko.toJSON($root, null, 2)"></pre>

<hr noshade />
<br />

</div>

</body>
</html>